<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Shoping cart</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>
    

</head>
<body>
	<div>
		<h1 ><p style="text-align:center;">Shoping-Shop</p> </h1>
	
	<ul>
	<div id="myData"></div>
</ul>
<h3><p style="text-align:center;">Welcome To My Cart <i class="fa fa-shopping-cart" style="font-size:50px"></i></p></h3>

    <ul>
        <div id="cart">
        </div>
    </ul>
	</div>

<script>
            function createProduct(data) {

                let product = document.createElement('h4');
                product.className = "cards";
                product.style = "float: left; width: 1000px";
                product.style.color = "tan";

                let index = document.createElement('div');
                index.style = "text-align: center; "
                index.innerText = data.id;
                index.style.color= "black";

                let quan = document.createElement('div');
                quan.style = "text-align:center"
                quan.innerText = "qnt:" + data.quantity;
                quan.style.color = "green";


                let title = document.createElement('div');
                title.innerText = data.name;
                title.style.color = "red";

                let price = document.createElement('div');
                price.innerText = "Price: " + data.price;

                let a = document.createElement('a');
                a.href = "/add/" + data.id;
                a.innerText = "Add to Cart";

                product.appendChild(index);
                product.appendChild(title);
                product.appendChild(price);
                product.appendChild(a);
                product.appendChild(quan);

                // console.log("total product card:" + product)

                return product
            }

            data = %(data)s
            cartData = %(cartData)s

            var dataContainer = document.getElementById("myData");
            var myCartContainer = document.getElementById("cart");
            console.log("cartData:", cartData);

            for (var i=0; i<data.length; i++) {
                let product = createProduct(data[i])
                dataContainer.appendChild(product)

                if (data[i].id in cartData) {
                    let div = document.createElement('div');
                    var fruits = [];
                    // fruits.push(data[i].price);
                    Array.prototype.insert = function ( index, item ) {
                        this.splice( index, 0, item );
                        };
                    fruits.insert(0, data[i].price)
                    for(let j = 0; j < fruits.length; j++){
                        console.log(fruits.length)
                        console.log(fruits,"123443482938298");
                        }

                    console.log(fruits,"snajsnajsnajsn")
                    // let sum = 0;
                    // for (let i = 0; i < fruits.length; i++) {
                    //     sum += fruits[i].price;

                    



                    //     }
                    // console.log(sum);


                    div.innerText = data[i].name + "\n Price:" + data[i].price + "\n Quantity:" + data[i].quantity +
                    "\n Total Price:=" + (data[i].price * data[i].quantity) + "\n"
                    // console.log(fruits,"---------------------------------------")



                    let a = document.createElement('a');
                    a.href = "/remove/" + data[i].id
                    a.innerHTML = "<button>Remove item from Cart</button><br><br>"

                    let b = document.createElement('a');
                    b.href = "/addin/" + data[i].id
                    // console.log("_______________________");
                    b.innerHTML = "<button> +</button><br>"


                    let c = document.createElement('a');
                    c.href = "/removein/" + data[i].id
                    console.log("_______________________");
                    c.innerHTML = "<button> - </button><br>"

                // if (data[i].price in cartData) {
                //     let d = document.createElement('div');
                //     let abcd = 0;
                //     abcd += data[i].price;
                //     d.innerText = data[i].name + "\n total total" + abcd
                    

                    myCartContainer.appendChild(div);
                    myCartContainer.appendChild(b);
                    myCartContainer.appendChild(c);
                    myCartContainer.appendChild(a);
                    // myCartContainer.appendChild(d);
                    

                }
            }

            // cartData !== undefined

            if (Object.keys(cartData).length === 0) {
                console.log("nothng is here!")
                console.log("some data",Object.keys(cartData))

                let div = document.createElement('div');
                div.innerText = "Your cart is Empty!"

                myCartContainer.appendChild(div);
            }
            else {
                let abcd = document.createElement('div')
                abcd.innerText = (cartData) + "\n" + "\n"


                let div = document.createElement('div');
                div.innerText = "Product added "

                myCartContainer.appendChild(div);
                myCartContainer.appendChild(abcd);
                }

            






                


                
             

</script>

</body>
</html>